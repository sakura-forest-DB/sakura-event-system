<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .navbar-brand { font-weight: bold; color: #2d5a27 !important; }
        .bg-primary { background-color: #2d5a27 !important; }
        .btn-primary { background-color: #2d5a27; border-color: #2d5a27; }
        .btn-primary:hover { background-color: #1e3c1a; border-color: #1e3c1a; }
        footer { background-color: #f8f9fa; margin-top: auto; }
        .form-section { border-left: 4px solid #2d5a27; padding-left: 15px; margin-bottom: 2rem; }
        .required { color: #dc3545; }
        .form-check-input:checked { background-color: #2d5a27; border-color: #2d5a27; }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">
    <!-- ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰è¡¨ç¤º -->
    <div class="alert alert-warning mb-0 text-center border-0 rounded-0" style="background: linear-gradient(45deg, #ffc107, #ffca2c);">
        <strong>ğŸ”§ ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰</strong> - ç®¡ç†è€…ã¨ã—ã¦æ“ä½œä¸­ã§ã™
    </div>
    
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="/">ğŸŒ¸ èŠåæ¡œå±±å…¬åœ’</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">ãƒ›ãƒ¼ãƒ </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/register">ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ç™»éŒ²</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/apply">ã‚¤ãƒ™ãƒ³ãƒˆç”³è¾¼</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/admin">ç®¡ç†ç”»é¢</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container my-4 flex-grow-1">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ç™»éŒ²ç·¨é›†</h2>
            <div>
                <a href="/admin/volunteers/<%= volunteer.id %>" class="btn btn-outline-secondary">è©³ç´°ã«æˆ»ã‚‹</a>
            </div>
        </div>

        <% if (errors && errors.length > 0) { %>
            <div class="alert alert-danger">
                <ul class="mb-0">
                    <% errors.forEach(error => { %>
                        <li><%= error %></li>
                    <% }); %>
                </ul>
            </div>
        <% } %>

        <form method="POST" action="/admin/volunteers/<%= volunteer.id %>/update">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">ğŸŒ± ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ç™»éŒ²æƒ…å ±</h4>
                </div>
                <div class="card-body">
                    <!-- åŸºæœ¬æƒ…å ± -->
                    <div class="form-section">
                        <h5>ğŸ“ åŸºæœ¬æƒ…å ±</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">ç™»éŒ²ç¨®åˆ¥ <span class="required">*</span></label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="type" id="individual" value="individual" 
                                           <%= volunteer.type === 'individual' ? 'checked' : '' %>>
                                    <label class="form-check-label" for="individual">å€‹äºº</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="type" id="org" value="org"
                                           <%= volunteer.type === 'org' ? 'checked' : '' %>>
                                    <label class="form-check-label" for="org">å›£ä½“</label>
                                </div>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="name" class="form-label"><%= volunteer.type === 'org' ? 'ä»£è¡¨è€…å' : 'æ°å' %> <span class="required">*</span></label>
                                <input type="text" class="form-control" id="name" name="name" 
                                       value="<%= volunteer.name %>" required>
                            </div>
                            <div class="col-md-6" id="orgNameField" style="display: <%= volunteer.type === 'org' ? 'block' : 'none' %>">
                                <label for="orgName" class="form-label">å›£ä½“å</label>
                                <input type="text" class="form-control" id="orgName" name="orgName" 
                                       value="<%= volunteer.orgName || '' %>">
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="email" class="form-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required">*</span></label>
                                <input type="email" class="form-control" id="email" name="email" 
                                       value="<%= volunteer.email %>" required>
                            </div>
                            <div class="col-md-6">
                                <label for="phone" class="form-label">é›»è©±ç•ªå·</label>
                                <input type="tel" class="form-control" id="phone" name="phone" 
                                       value="<%= volunteer.phone || '' %>">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="address" class="form-label">ä½æ‰€</label>
                            <input type="text" class="form-control" id="address" name="address" 
                                   value="<%= volunteer.address || '' %>">
                        </div>
                    </div>

                    <!-- ã‚¹ã‚­ãƒ«ãƒ»çµŒé¨“ -->
                    <div class="form-section">
                        <h5>ğŸ’¡ ã‚¹ã‚­ãƒ«ãƒ»çµŒé¨“</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <%
                                let skillsData = [];
                                try {
                                    skillsData = JSON.parse(volunteer.skills || '[]');
                                } catch (e) {
                                    skillsData = [];
                                }
                                %>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="skills" value="åœ’èŠ¸" id="skill-gardening"
                                           <%= skillsData.includes('åœ’èŠ¸') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="skill-gardening">åœ’èŠ¸</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="skills" value="éŸ³æ¥½" id="skill-music"
                                           <%= skillsData.includes('éŸ³æ¥½') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="skill-music">éŸ³æ¥½</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="skills" value="ã‚¤ãƒ™ãƒ³ãƒˆé‹å–¶" id="skill-event"
                                           <%= skillsData.includes('ã‚¤ãƒ™ãƒ³ãƒˆé‹å–¶') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="skill-event">ã‚¤ãƒ™ãƒ³ãƒˆé‹å–¶</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="skills" value="æ–™ç†" id="skill-cooking"
                                           <%= skillsData.includes('æ–™ç†') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="skill-cooking">æ–™ç†</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <%
                                let interestsData = [];
                                try {
                                    const interestsParts = (volunteer.interests || '').split('|');
                                    if (interestsParts[0]) {
                                        interestsData = JSON.parse(interestsParts[0]);
                                    }
                                } catch (e) {
                                    interestsData = [];
                                }
                                %>
                                <label class="form-label">èˆˆå‘³ã®ã‚ã‚‹æ´»å‹•</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="interests" value="è‡ªç„¶ä¿è­·" id="interest-nature"
                                           <%= interestsData.includes('è‡ªç„¶ä¿è­·') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="interest-nature">è‡ªç„¶ä¿è­·</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="interests" value="æ–‡åŒ–æ´»å‹•" id="interest-culture"
                                           <%= interestsData.includes('æ–‡åŒ–æ´»å‹•') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="interest-culture">æ–‡åŒ–æ´»å‹•</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="interests" value="åœ°åŸŸäº¤æµ" id="interest-community"
                                           <%= interestsData.includes('åœ°åŸŸäº¤æµ') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="interest-community">åœ°åŸŸäº¤æµ</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="interests" value="å­ã©ã‚‚å‘ã‘æ´»å‹•" id="interest-children"
                                           <%= interestsData.includes('å­ã©ã‚‚å‘ã‘æ´»å‹•') ? 'checked' : '' %>>
                                    <label class="form-check-label" for="interest-children">å­ã©ã‚‚å‘ã‘æ´»å‹•</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ä¿å…¨æ´»å‹• -->
                    <div class="form-section">
                        <h5>ğŸŒ² å‚åŠ ã—ãŸã„ä¿å…¨æ´»å‹•</h5>
                        <%
                        let conservationData = [];
                        try {
                            const interestsParts = (volunteer.interests || '').split('|');
                            if (interestsParts[1]) {
                                conservationData = JSON.parse(interestsParts[1]);
                            }
                        } catch (e) {
                            conservationData = [];
                        }
                        %>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="conservationActivities" value="è‰åˆˆã‚Šä½œæ¥­" id="activity-weeding"
                                   <%= conservationData.includes('è‰åˆˆã‚Šä½œæ¥­') ? 'checked' : '' %>>
                            <label class="form-check-label" for="activity-weeding">ğŸŒ± è‰åˆˆã‚Šä½œæ¥­</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="conservationActivities" value="èŠ±å£‡æ•´å‚™" id="activity-flower"
                                   <%= conservationData.includes('èŠ±å£‡æ•´å‚™') ? 'checked' : '' %>>
                            <label class="form-check-label" for="activity-flower">ğŸŒ¸ èŠ±å£‡æ•´å‚™</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="conservationActivities" value="è½è‘‰æ¸…æƒ" id="activity-cleanup"
                                   <%= conservationData.includes('è½è‘‰æ¸…æƒ') ? 'checked' : '' %>>
                            <label class="form-check-label" for="activity-cleanup">ğŸ‚ è½è‘‰æ¸…æƒ</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="conservationActivities" value="æ¤æ¨¹æ´»å‹•" id="activity-planting"
                                   <%= conservationData.includes('æ¤æ¨¹æ´»å‹•') ? 'checked' : '' %>>
                            <label class="form-check-label" for="activity-planting">ğŸŒ³ æ¤æ¨¹æ´»å‹•</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="conservationActivities" value="éŠæ­©é“æ•´å‚™" id="activity-trail"
                                   <%= conservationData.includes('éŠæ­©é“æ•´å‚™') ? 'checked' : '' %>>
                            <label class="form-check-label" for="activity-trail">ğŸ¥¾ éŠæ­©é“æ•´å‚™</label>
                        </div>
                    </div>

                    <!-- å‚™è€ƒãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
                    <div class="form-section">
                        <h5>ğŸ’¬ å‚™è€ƒãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</h5>
                        <div class="mb-3">
                            <label for="notes" class="form-label">ãã®ä»–ã”è³ªå•ãƒ»ã”è¦æœ›ç­‰</label>
                            <textarea class="form-control" id="notes" name="notes" rows="3"><%= volunteer.notes || '' %></textarea>
                        </div>
                    </div>

                    <!-- å¤‰æ›´ç†ç”±ãƒ»ç·¨é›†è€… -->
                    <div class="form-section">
                        <h5>ğŸ“‹ å¤‰æ›´æƒ…å ±</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="editor" class="form-label">ç·¨é›†è€…å <span class="required">*</span></label>
                                <input type="text" class="form-control" id="editor" name="editor" required
                                       placeholder="ä¾‹: ç”°ä¸­å¤ªéƒ">
                            </div>
                            <div class="col-md-6">
                                <label for="reason" class="form-label">å¤‰æ›´ç†ç”± <span class="required">*</span></label>
                                <input type="text" class="form-control" id="reason" name="reason" required
                                       placeholder="ä¾‹: ç™»éŒ²è€…ã‹ã‚‰ã®å¤‰æ›´ä¾é ¼">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mt-4">
                <button type="submit" class="btn btn-primary btn-lg me-3">ğŸ’¾ ä¿å­˜</button>
                <a href="/admin/volunteers/<%= volunteer.id %>" class="btn btn-outline-secondary btn-lg">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>
            </div>
        </form>
    </main>

    <footer class="py-3 mt-4">
        <div class="container text-center text-muted">
            <p>&copy; 2025 èŠåæ¡œå±±å…¬åœ’ ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const typeRadios = document.querySelectorAll('input[name="type"]');
        const orgNameField = document.getElementById('orgNameField');
        
        typeRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'org') {
                    orgNameField.style.display = 'block';
                } else {
                    orgNameField.style.display = 'none';
                }
            });
        });
    });
    </script>
</body>
</html>