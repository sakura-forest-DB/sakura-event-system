<%- include('partials/header', { title: 'Forest Christmas 2025' }) %>

<main>
  <!-- ヒーローセクション -->
  <section class="hero-section">
    <div class="container text-center">
      <h1 class="display-4 fw-bold mb-3">Forest Christmas 2025</h1>
      <p class="lead mb-4">菊名桜山公園で素敵なクリスマスを一緒に作りましょう</p>
      <p>地域の自然と文化を守り、育てる活動にご参加ください</p>
    </div>
  </section>

  <!-- 申込ボタンエリア -->
  <section class="container my-5">
    <div class="d-grid gap-3 d-md-flex justify-content-md-center">
      <% if (upcomingEvents && upcomingEvents.length > 0) { %>
        <!-- 直近イベントに紐づいた3ボタン -->
        <a href="/register" class="btn btn-volunteer btn-lg">
          🙋 ボランティア登録
        </a>
        <a href="/apply/<%= upcomingEvents[0].slug %>/stall" class="btn btn-stall btn-lg">
          🏪 出店申込
        </a>
        <a href="/apply/<%= upcomingEvents[0].slug %>/performer" class="btn btn-performer btn-lg">
          🎭 出演申込
        </a>
      <% } else { %>
        <!-- イベントがない場合は申込系を無効化 -->
        <a href="/register" class="btn btn-volunteer btn-lg">
          🙋 ボランティア登録
        </a>
        <button class="btn btn-stall btn-lg" disabled>
          🏪 出店申込（準備中）
        </button>
        <button class="btn btn-performer btn-lg" disabled>
          🎭 出演申込（準備中）
        </button>
      <% } %>
    </div>
  </section>

  <!-- 募集中のイベント一覧 -->
  <section class="container my-5">
    <h2 class="mb-4 text-center">募集中のイベント</h2>

    <% if (upcomingEvents && upcomingEvents.length > 0) { %>
      <div class="row g-4">
        <% upcomingEvents.forEach(function(event){ %>
          <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title text-success fw-bold"><%= event.title %></h5>
                <p class="card-text">
                  <strong>📅 開催日：</strong><%= new Date(event.date).toLocaleDateString('ja-JP', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'short' }) %><br>
                  <strong>📍 会場：</strong><%= event.location || '菊名桜山公園' %>
                </p>

                <% if (event.description) { %>
                  <p class="card-text text-muted small"><%= event.description %></p>
                <% } %>

                <div class="mt-auto">
                  <% if (!event.applicationStartDate || new Date(event.applicationStartDate) <= new Date()) { %>
                    <a href="/apply/<%= event.slug %>" class="btn btn-view-all w-100">
                      詳細を見る・申し込む
                    </a>
                  <% } else { %>
                    <button class="btn btn-secondary w-100" disabled>
                      申込開始：<%= new Date(event.applicationStartDate).toLocaleDateString('ja-JP', { month: 'long', day: 'numeric' }) %>
                    </button>
                  <% } %>
                </div>
              </div>
            </div>
          </div>
        <% }); %>
      </div>
    <% } else { %>
      <div class="text-center py-5">
        <p class="text-muted fs-5">現在募集中のイベントはありません。</p>
        <p class="text-muted">新しいイベントの情報をお待ちください。</p>
      </div>
    <% } %>
  </section>
</main>

<%- include('partials/footer') %>
